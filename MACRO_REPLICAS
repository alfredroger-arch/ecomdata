Sub ReplicarRegistros31Veces()
    Dim wsBase As Worksheet
    Dim wsDestino As Worksheet
    Dim ultimaFila As Long, ultimaColumna As Long
    Dim totalRegistros As Long
    Dim i As Long, j As Long, k As Long
    Dim filaDestino As Long
    Dim fechaInicio As Date
    Dim colResultado As Long, colObjetivo As Long, colAlcance As Long
    
    ' ⭐⭐ CAMBIA AQUÍ EL MES ⭐⭐
    ' 8 = Agosto, 9 = Septiembre, 10 = Octubre, etc.
    fechaInicio = DateSerial(2025, 9, 1)   ' Septiembre 2025
    
    ' Configurar la hoja BASE
    Set wsBase = ThisWorkbook.Worksheets("BASE")
    
    ' Crear nueva hoja para los resultados
    On Error Resume Next
    Application.DisplayAlerts = False
    ThisWorkbook.Worksheets("RESULTADO").Delete
    Application.DisplayAlerts = True
    On Error GoTo 0
    
    Set wsDestino = ThisWorkbook.Worksheets.Add(After:=wsBase)
    wsDestino.Name = "RESULTADO"
    
    ' Encontrar última fila y columna con datos en BASE
    ultimaFila = wsBase.Cells(wsBase.Rows.Count, 1).End(xlUp).Row
    ultimaColumna = wsBase.Cells(1, wsBase.Columns.Count).End(xlToLeft).Column
    totalRegistros = ultimaFila - 1
    
    ' Copiar cabeceras originales (columnas A hasta D)
    For k = 1 To 4
        wsDestino.Cells(1, k).Value = wsBase.Cells(1, k).Value
    Next k
    
    ' Agregar nuevas cabeceras
    wsDestino.Cells(1, 5).Value = "FECHA"
    wsDestino.Cells(1, 6).Value = "RESULTADO"
    wsDestino.Cells(1, 7).Value = "OBJETIVO"
    wsDestino.Cells(1, 8).Value = "ALCANCE"
    wsDestino.Cells(1, 9).Value = "RESULTADO MES"
    wsDestino.Cells(1, 10).Value = "OBJETIVO MES"
    wsDestino.Cells(1, 11).Value = "ALCANCE MES"
    
    ' Inicializar contador de fila destino
    filaDestino = 2
    
    ' Configurar aplicación para mejor rendimiento
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.EnableEvents = False
    
    ' Procesar cada registro
    For i = 2 To ultimaFila
        ' Para cada día del mes (1 al 31)
        For j = 1 To 31
            ' Copiar datos originales (columnas A hasta D)
            For k = 1 To 4
                wsDestino.Cells(filaDestino, k).Value = wsBase.Cells(i, k).Value
            Next k
            
            ' Agregar fecha (columna E)
            wsDestino.Cells(filaDestino, 5).Value = DateAdd("d", j - 1, fechaInicio)
            wsDestino.Cells(filaDestino, 5).NumberFormat = "dd/mm/yyyy"
            
            ' Calcular las columnas de origen para este día (valores diarios)
            colResultado = 8 + ((j - 1) * 3)    ' Columna para RESULTADO
            colObjetivo = colResultado + 1       ' Columna para OBJETIVO
            colAlcance = colResultado + 2        ' Columna para ALCANCE
            
            ' Copiar valores diarios a las columnas F, G, H
            If colResultado <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 6).Value = wsBase.Cells(i, colResultado).Value
            End If
            
            If colObjetivo <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 7).Value = wsBase.Cells(i, colObjetivo).Value
            End If
            
            If colAlcance <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 8).Value = wsBase.Cells(i, colAlcance).Value
            End If
            
            ' Copiar valores mensuales (columnas I, J, K)
            ' RESULTADO MES = Columna E de BASE
            If 5 <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 9).Value = wsBase.Cells(i, 5).Value
            End If
            
            ' OBJETIVO MES = Columna F de BASE
            If 6 <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 10).Value = wsBase.Cells(i, 6).Value
            End If
            
            ' ALCANCE MES = Columna G de BASE
            If 7 <= ultimaColumna Then
                wsDestino.Cells(filaDestino, 11).Value = wsBase.Cells(i, 7).Value
            End If
            
            filaDestino = filaDestino + 1
        Next j
        
        ' Mostrar progreso
        If i Mod 10 = 0 Then
            Application.StatusBar = "Procesando registro " & i - 1 & " de " & totalRegistros & _
                                   " (" & Format((i - 1) / totalRegistros, "0%") & " completado)"
            DoEvents
        End If
    Next i
    
    ' Ajustar formato de columnas
    AjustarFormatoColumnas wsDestino
    
    ' Restaurar configuración
    Application.StatusBar = False
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    Application.EnableEvents = True
    
    ' Mostrar mensaje de finalización
    MsgBox "Proceso completado!" & vbCrLf & _
           "Registros originales: " & totalRegistros & vbCrLf & _
           "Total de filas generadas: " & filaDestino - 2 & vbCrLf & _
           "Ubicación: Hoja 'RESULTADO'", _
           vbInformation, "Macro Finalizada"
    
    ' Limpiar objetos
    Set wsBase = Nothing
    Set wsDestino = Nothing
End Sub

' Ajustar formato de columnas
Sub AjustarFormatoColumnas(wsDestino As Worksheet)
    ' Ajustar ancho de columnas
    wsDestino.Columns(1).ColumnWidth = 15 ' Columna A
    wsDestino.Columns(2).ColumnWidth = 15 ' Columna B
    wsDestino.Columns(3).ColumnWidth = 15 ' Columna C
    wsDestino.Columns(4).ColumnWidth = 15 ' Columna D
    wsDestino.Columns(5).ColumnWidth = 12 ' FECHA
    wsDestino.Columns(6).ColumnWidth = 15 ' RESULTADO
    wsDestino.Columns(7).ColumnWidth = 15 ' OBJETIVO
    wsDestino.Columns(8).ColumnWidth = 15 ' ALCANCE
    wsDestino.Columns(9).ColumnWidth = 15 ' RESULTADO MES
    wsDestino.Columns(10).ColumnWidth = 15 ' OBJETIVO MES
    wsDestino.Columns(11).ColumnWidth = 15 ' ALCANCE MES
    
    ' Formato de fecha para toda la columna E
    With wsDestino.Columns(5)
        .NumberFormat = "dd/mm/yyyy"
        .HorizontalAlignment = xlCenter
    End With
    
    ' Formato para las columnas de datos
    With wsDestino.Range("F:K")
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
    End With
    
    ' Congelar paneles para ver cabeceras
    wsDestino.Activate
    wsDestino.Cells(2, 12).Select
    ActiveWindow.FreezePanes = True
    
    ' Autoajustar texto si es necesario
    wsDestino.Rows(1).Font.Bold = True
    wsDestino.Rows(1).HorizontalAlignment = xlCenter
    
    ' Aplicar bordes a toda la tabla
    With wsDestino.Range("A1").CurrentRegion
        .Borders.LineStyle = xlContinuous
        .Borders.Weight = xlThin
    End With
End Sub
